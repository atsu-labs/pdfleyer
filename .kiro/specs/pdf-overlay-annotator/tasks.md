# Implementation Tasks — pdf-overlay-annotator

以下は設計と要件に基づいて実装チームが取り組むための実行可能タスク一覧です（サブタスクは各 1–3 時間想定）。

-- [x] 1. PDF 読込と表示基盤の実装
  - PDF.js を組み込み、PDF ファイルの最初のページをクライアントでレンダリングする（約2時間）
  - _Requirements: 1.1_

-- [x] 1.1 ページネーション UI とページ切替の実装
  - ページ一覧/前後移動 UI を作成し、任意ページを表示できるようにする（約2時間）
  - _Requirements: 1.2_

- [x] 1.2 レンダリング失敗時のエラーハンドリングとテスト
  - レンダリングエラー時にユーザーへ分かりやすいメッセージを出し、自動テストを追加する（約2時間）
  - _Requirements: 1.3_

- [x] 2. オーバーレイの描画ツール実装（基本ツール）
  - 矩形・円・線・フリーハンド・テキストの描画ツールを実装する（約3時間）
  - 各ツールの UI 操作（選択・描画確定）を作る
  - _Requirements: 2.1_

- [x] 2.1 選択・移動・リサイズ・削除操作の実装
  - 描画済み図形の選択、移動、サイズ変更、削除を可能にする（約3時間）
  - _Requirements: 2.2_

- [ ] 2.2 テキスト属性編集の実装
  - 追加したテキスト要素の文字内容、フォントサイズ、色の編集 UI を実装（約2時間）
  - _Requirements: 2.3_

- [ ] 2.3 Undo/Redo 機能の実装と単体テスト
  - 操作履歴管理（Undo/Redo）を実装し、単体テストを追加（約3時間）
  - _Requirements: 2.4_

- [ ] 3. 注釈の保存・復元・エクスポート API 実装
  - Backend に注釈永続化用の REST エンドポイントを実装し、Annotation JSON を保存可能にする（約3時間）
  - _Requirements: 3.1_

- [ ] 3.1 クライアント側の保存/復元フロー実装
  - 保存ボタンと復元処理をクライアントに実装し、ローカル保存（IndexedDB）フォールバックを用意（約2時間）
  - _Requirements: 3.2_

- [ ] 3.2 エクスポート（PDF に埋め込み / JSON エクスポート）の実装
  - 注釈を埋め込んだフラット化 PDF を生成するサーバ側処理と JSON ダンプのエクスポート機能を実装（約3時間）
  - _Requirements: 3.3_

- [ ] 4. パフォーマンス最適化とモバイル対応
  - Canvas レイヤリングや仮想化を用いたレンダリング最適化を行う（約3時間）
  - _Requirements: 4.1_

- [ ] 4.1 タッチ操作最適化（モバイル UX）実装
  - タッチジェスチャー対応、タッチ用 UI 調整を実施（約3時間）
  - _Requirements: 4.2_

- [ ] 4.2 パフォーマンステスト作成とベンチマーク実施
  - 指定条件（ページ内 100 件の図形など）でパフォーマンス測定シナリオを作成し測定（約2時間）
  - _Requirements: 4.1_

- [ ] 5. セキュリティと権限実装
  - HTTPS 前提での API 通信、JWT 認証の導入を行う（約2時間）
  - _Requirements: 5.1_

- [ ] 5.1 共有時のアクセス制御（ACL）実装
  - 注釈に閲覧/編集権限を付与・検査する仕組みを実装（約2時間）
  - _Requirements: 5.2_

- [ ] 6. 統合・テスト・CI 設定
  - Overlay ロジックのユニットテストを追加（約2時間）
  - Integration テスト（保存→復元→エクスポートのフロー）を作成（約3時間）
  - E2E テスト（PDF 読込→描画→保存→再読み込み）を作成（約3時間）
  - CI にテストジョブを追加（約2時間）
  - _Requirements: 2.*,3.* (cross-cutting)_

---
合計: 6 major tasks、計 15 サブタスク（見積りサブタスク平均 1.9 時間）。すべての要件領域（1〜5）をカバーしています。
